<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Machine: Puppy - HackTheBox Season 8 Write-up</title>
    <meta name="description" content="A detailed walkthrough of the Lame box on HackTheBox, focusing on FTP misconfiguration exploitation.">
    <meta name="date" content="2025-05-18">
    <meta name="author" content="UZIII2208">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link href="../../css/styles.css" rel="stylesheet">
</head>
<body class="min-h-screen">
    <!-- Navigation -->
    <nav class="fixed top-0 w-full bg-gray-900 shadow-lg z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="/" class="text-green-400 hover:text-green-500 font-bold text-xl">UZIII2208</a>
                </div>
                <!-- Desktop Menu -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="/" class="nav-link px-3 py-2">Home</a>
                        <a href="/pages/about.html" class="nav-link px-3 py-2">About</a>
                        <a href="/pages/hackthebox.html" class="nav-link px-3 py-2">HackTheBox</a>
                        <a href="/pages/tryhackme.html" class="nav-link px-3 py-2">TryHackMe</a>
                        <a href="/pages/blogs.html" class="nav-link px-3 py-2">Blogs</a>
                        <a href="/pages/contact.html" class="nav-link px-3 py-2">Contact</a>
                        <a href="/pages/complaints.html" class="nav-link px-3 py-2">Complaints</a>
                        <button onclick="toggleSearch()" class="theme-toggle mr-4">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </button>
                        <button id="theme-toggle" onclick="toggleTheme()" class="theme-toggle">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                            </svg>
                        </button>
                        <div id="search-container" class="search-container hidden ml-4">
                            <input type="text" id="search-input" class="search-input" placeholder="Search posts..." oninput="performSearch()">
                            <div id="search-results" class="search-results hidden"></div>
                        </div>
                        </button>
                    </div>
                </div>
                <!-- Mobile menu button -->
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-gray-300 hover:text-white">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="/" class="nav-link block px-3 py-2">Home</a>
                <a href="/pages/about.html" class="nav-link block px-3 py-2">About</a>
                <a href="/pages/hackthebox.html" class="nav-link block px-3 py-2">HackTheBox</a>
                <a href="/pages/tryhackme.html" class="nav-link block px-3 py-2">TryHackMe</a>
                <a href="/pages/blogs.html" class="nav-link block px-3 py-2">Blogs</a>
                <a href="/pages/contact.html" class="nav-link block px-3 py-2">Contact</a>
                <a href="/pages/complaints.html" class="nav-link block px-3 py-2">Complaints</a>
                <button onclick="toggleSearch()" class="theme-toggle mr-4">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </button>
                <button id="theme-toggle" onclick="toggleTheme()" class="theme-toggle">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                    </svg>
                </button>
                <div id="search-container" class="search-container hidden ml-4">
                    <input type="text" id="search-input" class="search-input" placeholder="Search posts..." oninput="performSearch()">
                    <div id="search-results" class="search-results hidden"></div>
                </div>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 container mx-auto px-4 sm:px-6 lg:px-8">
        <article class="max-w-4xl mx-auto py-16 fade-in">
            <header class="mb-12">
                <img src="../hackthebox/puppy/puppy_htb.png" alt="Puppy Banner" class="rounded-lg shadow-lg mb-6">
                <h1 class="text-4xl md:text-6xl text-green-400 font-bold mb-4">Machine: Puppy - HackTheBox Season 8</h1>
                <div class="flex items-center space-x-4 text-gray-400">
                    <time datetime="2025-05-18">May 18, 2025</time>
                    <span>•</span>
                    <span>HackTheBox</span>
                </div>
            </header>

            <div class="prose prose-lg prose-invert max-w-none">
                <h2 class="text-2xl text-green-400 mt-8 mb-4">Information</h2>
                <table class="w-full border-collapse border border-gray-700 mb-6">
                  <thead>
                    <tr class="bg-gray-800">
                      <th class="border border-gray-700 p-2 text-left">General Information</th>
                      <th class="border border-gray-700 p-2 text-left">IP Address: 10.10.11.xx</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="border border-gray-700 p-2">Operating System (Distribution)</td>
                      <td class="border border-gray-700 p-2">Microsoft Windows Server 2022 Standard</td>
                    </tr>
                    <tr>
                      <td class="border border-gray-700 p-2">Kernel OS Version</td>
                      <td class="border border-gray-700 p-2">10.0.20348 N/A Build 20348</td>
                    </tr>
                    <tr>
                      <td class="border border-gray-700 p-2">Web Server Software and Version</td>
                      <td class="border border-gray-700 p-2">Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</td>
                    </tr>
                    <tr>
                      <td class="border border-gray-700 p-2">Available Ports</td>
                      <td class="border border-gray-700 p-2">53, 88, 111, 135, 139, 389, 445, 464, 593, 636, 2049, 3260, 3268, 3269, 5985</td>
                    </tr>
                  </tbody>
                </table>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Report Content Characteristics</h2>
                <blockquote>
                <li>I have explained in detail every task I performed in each
                step, accompanied by screenshots and the exploits used.</li>
                <li>The full write-up will be made public after Season 8 ends to
ensure transparency with HackTheBox policies. Please read carefully
before commenting, I’m not responsible for any issues that arise. If you
want to ask something, <strong class="text-green-400"><a href="/pages/contact.html">Contact Here</a></strong>!</li>
                </blockquote>
                <h2 class="text-2xl text-green-400 mt-8 mb-4">Enumeration</h2>
                <pre class="bg-gray-800 p-4 rounded-lg overflow-x-auto"><code>As is common in real life pentests, you will start the Puppy box with credentials for the following account: levi.james / KingofAkron2025!</code></pre>
                <p>Here,<strong class="text-green-400"><a href="https://app.hackthebox.com/users/1600618">tr3nb0lone</a></strong> (the machine creator) has provided the following username and password:</p>
                <li><strong>user:</strong> <strong class="text-green-400">levi.james</strong></li>
                <li><strong>password:</strong> <strong class="text-green-400">KingofAkron2025!</strong></li>
                <pre class="bg-gray-800 p-4 rounded-lg overflow-x-auto"><code>┌──(meow㉿uziii2208)-[~]
└─$ nmap -A 10.10.11.xx --min-rate 10000
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-17 15:00 EDT
Nmap scan report for 10.10.11.xx
Host is up (0.097s latency).
Not shown: 985 filtered tcp ports (no-response)
Bug in iscsi-info: no string output.
PORT STATE SERVICE VERSION
53/tcp open domain Simple DNS Plus
88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2025-05-18 02:00:50Z)
111/tcp open rpcbind 2-4 (RPC #100000)
| rpcinfo:
| program version port/proto service
| 100000 2,3,4 111/tcp rpcbind
| 100000 2,3,4 111/tcp6 rpcbind
| 100000 2,3,4 111/udp rpcbind
| 100000 2,3,4 111/udp6 rpcbind
| 100003 2,3 2049/udp nfs
| 100003 2,3 2049/udp6 nfs
| 100005 1,2,3 2049/udp mountd
| 100005 1,2,3 2049/udp6 mountd
| 100021 1,2,3,4 2049/tcp nlockmgr
| 100021 1,2,3,4 2049/tcp6 nlockmgr
| 100021 1,2,3,4 2049/udp nlockmgr
| 100021 1,2,3,4 2049/udp6 nlockmgr
| 100024 1 2049/tcp status
| 100024 1 2049/tcp6 status
| 100024 1 2049/udp status
|_ 100024 1 2049/udp6 status
135/tcp open msrpc Microsoft Windows RPC
139/tcp open netbios-ssn Microsoft Windows netbios-ssn
389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: PUPPY.HTB0., Site: Default-First-SiteName)
445/tcp open microsoft-ds?
464/tcp open kpasswd5?
593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0
636/tcp open tcpwrapped
2049/tcp open nlockmgr 1-4 (RPC #100021)
3260/tcp open iscsi?
3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: PUPPY.HTB0., Site: Default-First-Site-Name)
3269/tcp open tcpwrapped
5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2022|2012|2016 (89%)
OS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016
Aggressive OS guesses: Microsoft Windows Server 2022 (89%), Microsoft Windows Server 2012 R2 (85%), Microsoft Windows Server 2016 (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time:
| date: 2025-05-18T02:02:51
|_ start_date: N/A
|_clock-skew: 7h00m01s
| smb2-security-mode:
| 3:1:1:
|_ Message signing enabled and required

TRACEROUTE (using port 445/tcp)
HOP RTT ADDRESS
1 96.82 ms 10.10.11.xx
2 96.78 ms 10.10.11.xx

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 176.71 seconds</code></pre>

                <li>Use <strong class="text-green-400">CrackMapExec</strong> to scan users, taking advantage of existing account and password information.</li>
                <pre class="bg-gray-800 p-4 rounded-lg overflow-x-auto"><code>┌──(meow㉿uziii2208)-[~]
└─$ sudo crackmapexec smb 10.10.11.xx -u levi.james -p 'KingofAkron2025!' --users
SMB 10.10.11.xx 445 DC [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:PUPPY.H
TB) (signing:True) (SMBv1:False)
SMB 10.10.11.xx 445 DC [+] PUPPY.HTB\levi.james:KingofAkron2025!
SMB 10.10.11.xx 445 DC [+] Enumerated domain user(s)
SMB 10.10.11.xx 445 DC PUPPY.HTB\************_adm badpwdcount: 5 desc:
SMB 10.10.11.xx 445 DC PUPPY.HTB\************ badpwdcount: 5 desc:
SMB 10.10.11.xx 445 DC PUPPY.HTB\************** badpwdcount: 5 desc:
SMB 10.10.11.xx 445 DC PUPPY.HTB\*********** badpwdcount: 0 desc:
SMB 10.10.11.xx 445 DC PUPPY.HTB\********** badpwdcount: 0 desc:
SMB 10.10.11.xx 445 DC PUPPY.HTB\********** badpwdcount: 0 desc:
SMB 10.10.11.xx 445 DC PUPPY.HTB\****** badpwdcount: 0 desc: Key Distribution Center Service Account
SMB 10.10.11.xx 445 DC PUPPY.HTB\Guest badpwdcount: 0 desc: Built-in account for guest access to the computer/domain
SMB 10.10.11.xx 445 DC PUPPY.HTB\Administrator badpwdcount: 0 desc: Built-in account for administering the computer/domain</code></pre>

                <li>Add <strong class="text-green-400">DC.PUPPY.HTB</strong> and <strong class="text-green-400">PUPPY.HTB</strong> (domain name and domain controller) to the <strong class="text-green-400">/etc/hosts</strong> file.</li>
                <pre class="bg-gray-800 p-4 rounded-lg overflow-x-auto"><code>┌──(meow㉿uziii2208)-[~]
└─$ echo "10.10.11.xx DC.PUPPY.HTB PUPPY.HTB" | sudo tee -a /etc/hosts
10.10.11.xx DC.PUPPY.HTB PUPPY.HTB</code></pre>

                <li>Split the list of users and write it to a file <strong class="text-green-400">users.txt</strong>.</li>
                <pre class="bg-gray-800 p-4 rounded-lg overflow-x-auto"><code>┌──(meow㉿uziii2208)-[~/Desktop/HTB/Puppy]
└─$ nxc smb PUPPY.HTB -u 'levi.james' -p 'KingofAkron2025!' --rid-brute | grep "SidTypeUser" | awk -F '\\' '{print$2}' | awk '{print $1}' > users.txt
┌──(meow㉿uziii2208)-[~/Desktop/HTB/Puppy]
└─$ cat users.txt
Administrator
Guest
******
***
**********
**********
***********
**************
************
************_adm</code></pre>

                <li>Add the <strong class="text-green-400">domain controller's</strong> IP address to the <strong class="text-green-400">/etc/resolv.conf</strong> file and run a scan using <strong class="text-green-400">bloodhound-python</strong>.</li>
                <pre class="bg-gray-800 p-4 rounded-lg overflow-x-auto"><code>┌──(meow㉿uziii2208)-[~/Desktop/HTB/Puppy]
└─$ sudo nano /etc/resolv.conf

┌──(meow㉿uziii2208)-[~/Desktop/HTB/Puppy]
└─$ cat /etc/resolv.conf
nameserver 10.10.11.xx
nameserver 8.8.8.8
nameserver 1.1.1.1
nameserver 192.168.0.1

┌──(meow㉿uziii2208)-[~/Desktop/HTB/Puppy]
└─$ bloodhound-python -dc DC.PUPPY.HTB -u 'levi.james' -p 'KingofAkron2025!' -d PUPPY.HTB -c All -o bloound_results.json -ns 10.10.11.xx
INFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)
INFO: Found AD domain: puppy.htb
INFO: Getting TGT for user
WARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_
ERR_SKEW(Clock skew too great)
INFO: Connecting to LDAP server: DC.PUPPY.HTB
INFO: Found 1 domains
INFO: Found 1 domains in the forest
INFO: Found 1 computers
INFO: Connecting to LDAP server: DC.PUPPY.HTB
INFO: Found 10 users
INFO: Found 56 groups
INFO: Found 3 gpos
INFO: Found 3 ous
INFO: Found 19 containers
INFO: Found 0 trusts
INFO: Starting computer enumeration with 10 workers
INFO: Querying computer: DC.PUPPY.HTB
INFO: Done in 00M 19S</code></pre>

                <img src="../hackthebox/puppy/bloodhound1.png" alt="BloodHound Results" class="rounded-lg shadow-lg mb-6">
                <li>Our user has <strong class="text-green-400">GenericWrite</strong> permissions on the <strong class="text-green-400">Developers</strong> group, but we cannot proceed further with this privilege, so we need to dig deeper.</li>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Exploitation (Advanced Hacking)</h2>
                <p><strong class="text-yellow-400">Coming soon...</strong></p>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Initial Access</h2>
                <p><strong class="text-yellow-400">Coming soon...</strong></p>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Privilege Escalation</h2>
                <p><strong class="text-yellow-400">Coming soon...</strong></p>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Flags Found</h2>
                <ol class="list-decimal list-inside space-y-4">
                    
                    <li><strong>User flag :</strong> <strong class="text-red-400">b45******************************</strong></li>
                    <li><strong>Root flag :</strong> <strong class="text-red-400">2ce******************************</strong></li>
                    <p>Note: <strong class="text-red-400">Flags in all HTB machines are dynamic flags. It is strictly prohibited to dump flags or copy and paste flags blindly. If you try this, you are genuinely foolish!!!</strong></p>
                </ol>
            </div>
        </article>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 mt-20">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-green-400 font-semibold mb-4">About</h3>
                    <p class="text-gray-400">Security research blog focusing on CTF write-ups, penetration testing, and cybersecurity insights.</p>
                </div>
                <div>
                    <h3 class="text-green-400 font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="/pages/hackthebox.html" class="text-gray-400 hover:text-green-400">HackTheBox</a></li>
                        <li><a href="/pages/tryhackme.html" class="text-gray-400 hover:text-green-400">TryHackMe</a></li>
                        <li><a href="/pages/blogs.html" class="text-gray-400 hover:text-green-400">Blog Posts</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-green-400 font-semibold mb-4">Connect</h3>
                    <ul class="space-y-2">
                        <li><a href="/pages/contact.html" class="text-gray-400 hover:text-green-400">Contact</a></li>
                        <li><a href="https://github.com/uziii2208" class="text-gray-400 hover:text-green-400" target="_blank">GitHub</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center">
                <p class="text-gray-400">&copy; 2025 @UZIII2208. Some rights reserved.</p>
                <p class="text-gray-500 text-sm mt-2">Built with Meow Meow :3</p>
            </div>
        </div>
    </footer>

    <script src="../../js/main.js"></script>
</body>
</html>
