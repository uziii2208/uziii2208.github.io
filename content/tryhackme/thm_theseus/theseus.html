<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="57x57" href="../../../favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../../../favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../../favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../../../favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../../favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../../../favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../../../favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../../../favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="../../../favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../../../favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../favicon/favicon-16x16.png">
    <link rel="manifest" href="../../../favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="../../../favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <title>Room: Theseus - TryHackMe Write-up</title>
    <meta name="description" content="Walkthrough of the first installment of the SuitGuy series of very hard challenges on TryHackMe.">
    <meta name="date" content="2025-05-31">
    <meta name="author" content="UZIII">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link href="../../../css/styles.css" rel="stylesheet">
</head>
<body class="min-h-screen">
    <!-- Navigation -->
    <nav class="fixed top-0 w-full bg-gray-900 shadow-lg z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="/" class="text-green-400 hover:text-green-500 font-bold text-xl">UZIII2208</a>
                </div>
                <!-- Desktop Menu -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="/" class="nav-link px-3 py-2">Home</a>
                        <a href="/pages/about.html" class="nav-link px-3 py-2">About</a>
                        <a href="/pages/blogs.html" class="nav-link px-3 py-2">Blogs</a>
                        <a href="/pages/hackthebox.html" class="nav-link px-3 py-2">HackTheBox</a>
                        <a href="/pages/tryhackme.html" class="nav-link px-3 py-2">TryHackMe</a>
                        <a href="/pages/contact.html" class="nav-link px-3 py-2">Contact</a>
                        <a href="/pages/complaints.html" class="nav-link px-3 py-2">Complaints</a>
                        <div class="flex items-center space-x-4">
                            <button onclick="toggleSearch()" class="theme-toggle search-button">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                            </button>
                            <button id="theme-toggle" onclick="toggleTheme()" class="theme-toggle">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                                </svg>
                            </button>
                            <button onclick="showVisitCount()" class="theme-toggle" id="visit-counter" title="Show Visit Count">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Mobile menu button -->
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-gray-300 hover:text-white">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden fixed inset-0 z-50">
            <!-- Backdrop with blur effect -->
            <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm" onclick="toggleMobileMenu()"></div>
            <!-- Menu Content -->
            <div class="relative h-full flex items-center justify-center" onclick="event.stopPropagation()">
                <div class="bg-gray-900 rounded-lg shadow-xl p-6 m-4 max-w-sm w-full transform transition-all relative">
                    <!-- Exit button -->
                    <button onclick="toggleMobileMenu()" class="absolute top-2 right-2 text-gray-400 hover:text-white p-2 hover:bg-gray-800 rounded-lg transition-all duration-300">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                    <div class="space-y-4 mt-6">
                        <a href="/" class="nav-link block px-4 py-2 text-lg text-center rounded-lg hover:bg-gray-800">Home</a>
                        <a href="/pages/about.html" class="nav-link block px-4 py-2 text-lg text-center rounded-lg hover:bg-gray-800">About</a>
                        <a href="/pages/blogs.html" class="nav-link block px-4 py-2 text-lg text-center rounded-lg hover:bg-gray-800">Blogs</a>
                        <a href="/pages/hackthebox.html" class="nav-link block px-4 py-2 text-lg text-center rounded-lg hover:bg-gray-800">HackTheBox</a>
                        <a href="/pages/tryhackme.html" class="nav-link block px-4 py-2 text-lg text-center rounded-lg hover:bg-gray-800">TryHackMe</a>
                        <a href="/pages/contact.html" class="nav-link block px-4 py-2 text-lg text-center rounded-lg hover:bg-gray-800">Contact</a>
                        <a href="/pages/complaints.html" class="nav-link block px-4 py-2 text-lg text-center rounded-lg hover:bg-gray-800">Complaints</a>
                        <div class="flex items-center flex-col space-y-4 mt-6">
                            <!-- Mobile Search Container -->
                            <div id="mobile-search-container" class="search-container hidden fixed inset-0 z-50">
                                <!-- Backdrop with blur effect -->
                                <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm" onclick="toggleMobileSearch()"></div>
                                <!-- Search Content -->
                                <div class="relative h-full flex items-center justify-center" onclick="event.stopPropagation()">
                                    <div class="bg-gray-900 rounded-lg shadow-xl p-6 m-4 max-w-2xl w-full transform transition-all">
                                        <div class="relative">
                                            <input type="text" id="mobile-search-input" class="search-input w-full rounded-lg bg-gray-800 border-2 border-green-400 text-gray-100 pr-10" placeholder="Search posts..." oninput="performSearch(event)" autofocus>
                                            <button onclick="toggleMobileSearch()" class="absolute right-2 top-2 text-gray-400 hover:text-white">
                                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                                </svg>
                                            </button>
                                        </div>
                                        <div id="mobile-search-results" class="search-results hidden mt-4 max-h-96 overflow-y-auto"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex space-x-4">
                                <button onclick="toggleMobileSearch()" class="theme-toggle search-button p-2 hover:bg-gray-800 rounded-lg">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                </button>
                                <button onclick="toggleTheme()" class="theme-toggle p-2 hover:bg-gray-800 rounded-lg">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                                    </svg>
                                </button>
                                <button onclick="showVisitCount()" class="theme-toggle p-2 hover:bg-gray-800 rounded-lg" title="Show Visit Count">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Search Overlay -->
    <div id="search-overlay" class="search-overlay fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm hidden z-50">
        <div class="absolute inset-0" onclick="closeSearch()"></div>
        <div class="relative min-h-screen flex items-center justify-center">
            <div class="bg-gray-900 rounded-lg shadow-xl p-6 m-4 max-w-2xl w-full transform transition-all">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-green-400">Search Posts</h3>
                    <button onclick="closeSearch()" class="text-gray-400 hover:text-white p-2 hover:bg-gray-800 rounded-lg transition-all duration-300">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="search-container w-full">
                    <input type="text" id="search-input" class="search-input w-full bg-gray-800 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="Search posts..." oninput="performSearch(event)">
                    <div id="search-results" class="search-results mt-4 max-h-96 overflow-y-auto"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="pt-20 container mx-auto px-4 sm:px-6 lg:px-8">
        <article class="max-w-4xl mx-auto py-16 fade-in">
            <header class="mb-12">
                <h1 class="text-4xl md:text-6xl text-green-400 font-bold mb-4">Theseus: Insane - TryHackMe Challenge Room</h1>
                <div class="flex items-center space-x-4 text-gray-400">
                    <time datetime="2025-05-31">May 31, 2025</time>
                    <span>•</span>
                    <span>TryHackMe</span>
                    <span>•</span>
                    <span class="text-purple-400">Insane</span>
                </div>
            </header>

            <div class="prose prose-lg prose-invert max-w-none">
                <div class="mb-8">
                    <img src="https://tryhackme-images.s3.amazonaws.com/room-icons/9c87676bf415d0fa4f7dfad790b8ba51.jpeg" alt="Theseus Challenge Banner" class="rounded-lg shadow-lg w-full">
                </div>

                <div class="bg-gray-800 p-6 rounded-lg mb-8">
                    <h2 class="text-2xl text-green-400 mb-4">Challenge Overview</h2>
                    <p class="mb-4">Welcome to the first installment of the SuitGuy series of very hard challenges. This room challenges you to follow the path of Theseus and survive the trials of the Labyrinth. The challenge requires both technical expertise and creative problem-solving skills.</p>
                    <div class="flex flex-wrap gap-4 mt-4">
                        <span class="bg-gray-700 px-3 py-1 rounded">Insane</span>
                        <span class="bg-gray-700 px-3 py-1 rounded">Web Security</span>
                        <span class="bg-gray-700 px-3 py-1 rounded">SSTI</span>
                    </div>
                </div>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Initial Enumeration</h2>
                <p>Our journey begins with basic enumeration of the target machine. Using Rustscan, we identified two open ports:</p>
                <pre class="text-gray-400 bg-gray-800 p-4 rounded-lg overflow-x-auto mb-4"><code>┌──(kali㉿kali)-[~]
└─$ rustscan -a 10.10.57.61 --ulimit 5500 -b 65535 -- -A -Pn
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |
| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |
`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
😵 https://admin.tryhackme.com

[~] The config file is expected to be at "/home/kali/.rustscan.toml"
[~] Automatically increasing ulimit value to 5500.
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
Open 10.10.57.61:22
Open 10.10.57.61:8080
[~] Starting Script(s)
[>] Script to be run Some("nmap -vvv -p {{port}} {{ip}}")

Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.
[~] Starting Nmap 7.93 ( https://nmap.org ) at 2023-07-01 21:34 EDT
NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 21:34
Completed Parallel DNS resolution of 1 host. at 21:34, 0.01s elapsed
DNS resolution of 1 IPs took 0.02s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating Connect Scan at 21:34
Scanning 10.10.57.61 [2 ports]
Discovered open port 22/tcp on 10.10.57.61
Discovered open port 8080/tcp on 10.10.57.61
Completed Connect Scan at 21:34, 0.19s elapsed (2 total ports)
Initiating Service scan at 21:34
Scanning 2 services on 10.10.57.61
Completed Service scan at 21:34, 6.41s elapsed (2 services on 1 host)
NSE: Script scanning 10.10.57.61.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 5.59s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.75s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.00s elapsed
Nmap scan report for 10.10.57.61
Host is up, received user-set (0.19s latency).
Scanned at 2023-07-01 21:34:46 EDT for 13s

PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 87c426884f42ae2c748bff662df0689d (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCz+HeNp9l/BIOcQooT/LeuPI0QdNtru49hzUMhdEZDwSMxsx6Ppjz62eLWn7kxziSQN1SjzfP9/FiEfT/8JiORFO5Lcqpd7NTTmNykKImIeCYbNQglFn4oXJA/YU6PCMLXlqV7JIUHKwyobAz36wlrnAC6ngTrzwhkv4mdiFwKtLtRD5bimyO7PIRKy8Diu/Bwm85AmXEet+jCw2D+Mh8mdzAVZ9TgChsld5l9MqtKzjV+Rh2qzL2RfXl6EcVObSOTeXcXL9qbTNp6zIyuILOyHmVg9fFeUWHlkT0kpOXNkJSw4OV2ewzx+m2j7Kd/LW7L6EV8WuoCIhUHL+KxtxO7
|   256 05f506fcdc86f8f2bae2eedf14c33de4 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIkRuZaOKjEeXbbFf0lK9iGbg2r2Kh2TVAYuPZlrwpAyuA1x7TW2z/CWVR1ug1qQ716dQq3JszyliVP3mc4lD9o=
|   256 9274cb39e1ce3190139d4cee27f806bc (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIK2IMzlmBlnHUMxet+ujPGmrV/I0eISqyTR5seIZrzBk
8080/tcp open  http    syn-ack Werkzeug httpd 1.0.1 (Python 2.7.17)
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
| http-methods: 
|_  Supported Methods: HEAD OPTIONS GET
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:34
Completed NSE at 21:34, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.60 seconds</code></pre>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Key Parameter Analysis</h2>
                <p>Using Arjun for parameter discovery, we confirmed the presence of the 'key' parameter. Initial testing revealed potential for:</p>
                <ul class="list-disc list-inside space-y-2 my-4">
                    <li>Cross-Site Scripting (XSS)</li>
                    <li>Server-Side Template Injection (SSTI)</li>
                </ul>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">SSTI Discovery and Exploitation</h2>
                <p>After testing various payloads, we confirmed SSTI vulnerability by using the following test:</p>
                <div class="bg-gray-800 p-6 rounded-lg my-4">
                    <code class="text-green-400">http://[target]:8080/?key={{7*7}}</code>
                </div>
                <p>The server responded with "49", confirming our suspicion of template injection vulnerability.</p>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Configuration Exploration</h2>
                <p>Further investigation of the application's configuration revealed interesting details through the following payload:</p>
                <div class="bg-gray-800 p-6 rounded-lg my-4">
                    <code class="text-green-400">http://[target]:8080/?key={{config.items()}}</code>
                </div>
                <p>This exposed various configuration settings and potential attack vectors for deeper exploitation.</p>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">That's How I Can Solve This Challenge - Write Up</h2>
                <iframe 
                    src="2e421a6054cdc10f0ef823a24b9a978a.html" 
                    class="w-full h-screen bg-gray-800 p-4 rounded-2xl overflow-x-auto"
                    style="border: none;">
                </iframe>

                <div class="bg-yellow-900 p-6 rounded-lg my-8">
                    <h3 class="text-xl text-yellow-400 mb-4">⚠️ Important Note</h3>
                    <p>As per the challenge creator's request, detailed exploitation steps and flags are not included in this write-up to maintain the challenge's value for future participants.</p>
                </div>

                <h2 class="text-2xl text-green-400 mt-8 mb-4">Key Takeaways</h2>
                <ul class="list-disc list-inside space-y-2">
                    <li>Always check for hidden parameters in web applications</li>
                    <li>Template injection vulnerabilities can be critical security issues</li>
                    <li>Configuration exposure can lead to deeper system compromise</li>
                    <li>Combining different testing techniques is crucial for success</li>
                </ul>

                <div class="bg-gray-800 p-6 rounded-lg my-8">
                    <h2 class="text-2xl text-green-400 mb-4">Tools Used</h2>
                    <ul class="list-disc list-inside space-y-2">
                        <li>Nmap, Rustscan - For initial port scanning</li>
                        <li>Arjun - For parameter discovery</li>
                        <li>Burp Suite - For request manipulation and testing</li>
                        <li>Python scripts - For payload generation and testing</li>
                    </ul>
                </div>
            </div>
        </article>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 mt-20">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-green-400 font-semibold mb-4">About</h3>
                    <p class="text-gray-400">Security research blog focusing on CTF write-ups, penetration testing, and
                        cybersecurity insights.</p>
                </div>
                <div>
                    <h3 class="text-green-400 font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="/pages/hackthebox.html" class="text-gray-400 hover:text-green-400">HackTheBox</a></li>
                        <li><a href="/pages/tryhackme.html" class="text-gray-400 hover:text-green-400">TryHackMe</a></li>
                        <li><a href="/pages/blogs.html" class="text-gray-400 hover:text-green-400">Blog Posts</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-green-400 font-semibold mb-4">Connect</h3>
                    <ul class="space-y-2">
                        <li><a href="/pages/contact.html" class="text-gray-400 hover:text-green-400">Contact</a></li>
                        <li><a href="https://github.com/uziii2208" class="text-gray-400 hover:text-green-400" target="_blank">GitHub</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center">
                <p class="text-gray-400">&copy; 2025 UZIII2208. Some rights reserved.</p>
                <p class="text-gray-500 text-sm mt-2">Built with Meow Meow :3</p>
            </div>
        </div>
    </footer>

    <script src="../../../js/main.js"></script>
    <script type="module" src="../../../js/background.js"></script>
</body>
</html>